# https://projecteuler.net/problem=396
import numpy as np


def number_to_binary_numpy(n, digits=4): # numpy does not support large ints
    result = [0] * digits
    for i in range(digits):
        result[i] = n % 2
        n = n >> 1
        # print(n)
    return result

# TODO: no protection against underflow
def minus_one(g, digit, base):
    if digit == 0:
        base += 1

    if g[digit] > 0:
        if digit < 2:
            # even uit
            # base += (g[digit] - 1)
            # g[digit] = 0
            # g[digit] -= 1
            #

            value = g[digit] - 1
            if digit > 0:
                if value > 1000: # use powermod for last stage when values are too large
                    # (a ^ b) % p.
                    # print("Too large, use powermod")
                    base = base * pow(2, value, 10000000000)
                else:
                    base = base * (2 ** value)
            else:
                base += value
            g[digit] = 0
        else:
            g[digit] -= 1
    else:
        g, base = minus_one(g, digit + 1, base)
        g[digit] = base - 1
    return g, base

def goodwin(G):
    base = 2
    g = number_to_binary_numpy(G) # start

    while True:
        # print(base, g)
        g, base = minus_one(g, 0, base)
        if (sum(g) == 0):
            break

    print(g, base - 2)
    return base - 2

# print(goodwin(15))

total = 0
for i in range(1, 16):
    b = goodwin(i)
    total += b
    print(b)

print("Total:", total)




# 3434911155235878678206589500877491846531683445250335042591859387205548377986869293760859005660067978560975027322361592182093183279933911949030530692052897353147440225616335811525508858139371943998260372728084182698352815293615049947570620132256939968127710722350543340349598154653381190891185495822252120161473283803115875078636098819768830646526966524681192766246024305459075012440191871099002717319750069560488260266494187600647566843842422051572749345930292127560885587762942187076702427715372057317024352104653999153034261420392256201275869154388782045655015835773868667787588978233345815718025415161312906992996763212634236882364557004231006290012568475753253214225323734432649521637968281970906987703320301917508902504700133958198219631609500676687778282180433415031285378739095561488575002882774835327287289025867621318219647185286177532488269083430818006624731770566931862469165765078868279810414231444847203225400654176057902419600108216633376453929193126085988943864000241539646707223819663750428043507895996587719097019681288743081786864374572926113277212049283552673780944169622885178510422329122384958226668149354582383728404350752804143614750156742643328951702218259015738739543506549626810299909488964820268313654862393845089438068131219201231075080122558523905073494484269186703835448182658748770087098626614843575802589482181209353270258544592224959794979587119372219021150459266107522215218358025725161433430464381118737708435587190769820773133193002187085481611344005336491226611256905459961921563744771288077832386304260286913932868712491375845875079738716973192948081376851471927600616469562943808425243054821951985398184988928529127897828258265049400059850586913706584666407396370426291090653650327877422428215511865966088333929307602688507228766749255749486013278798172093755395643454374763382606608211229194530468468297672965672159966878554421322375392566152263675503277921072721527775423302506235847006674689637858782422885121167448382514245590765817083931765192673323777598648319238953612883498565457708274463467259959301205351523098479042638410278987946212384031582082622094565019768547870154969332931837021407932996197799970044090376766828829509058770595254839427354677545653506394181904650867014770397168459099220723318916102479067944110793971661762962973938078169410861329184807429684543120729595284398718296491348004403905615557367292971847075743468525240053344756067554892983906734694770825946694141877704813562564455159757283852842500375834942302035300735860013297773146423847668158065331863019963890356731048446081712947073597255826336487505340821369116584878365067761232042364339762863977236526711628486479123698314508176963029912623944844345507192329748680605834181135773682512096298498451593614119663008926596656469466143220450704064176638249308824919321612513387315269030748201208918094625970072327800491350273818888060704838497458964916779744703865321357476803971893933921315138108499973639454897086737690425043979994231453302411050175234067417435859852815879960810628494849654074683566443807787965618050508831410122905599362732826504201926865255771487387830596315501038104493888154682553341703394981296820589179713523767200563606403616720451350423157995716274644486928901339620977823348869066137332677037666236014668560212152448235478856270366851572087076855329282261809932808151923916666018833715110159682755188252876708873030967052822818454303034703013964597509353850597317357070026759294091804247640061646548591249366510087512542396201351086072300756188939100364699459172986426577819037384164460002097740258319584741597419533752095394998927774862774536293060934515583002343979554847717356771803769105844390864643386868146209444149506456794527002648044681502258454455336609325560921909220889967307298459585912510581308587280007485349980685485317130449059368668120435486408374862199394780937759803512374724091611281460706781465457642264808474275542550526235119786333585522726469665232451873586657605136974485587576576419729367428970872925307073151558587563270156653748818164386349699386613272364318786914064726696385274128502789635646566525110394685487275581942736013986522140172746112286287332454673254247571283664546326215484576639220247696275343651662786811995894549972862738010478545100716281428585280609841886693363821710132823732587653817865177271289034964242949003278418602493070397559498382519582748714532227601841099380479819186463200356241965821624867345190798167187819996784928806356254207786496417058069858745219663657174175750846001840878789932634281850824875161830666881315738859940528951530604163839580626534622710828166224699227652627770094242529507858019521588461852741345413292749515982042418779041700966175695313931700174658077417746372320275747708942681791579846568327000471058405505783981399432723068405711502423571826605207976171901298161416698727859768912543833267502508840776991807648454209165920936024775078504476593009758102988724342743594009974482174576085794245703199302713381960001443785110499950249860620660301081583415110925401198099899851712657355733040890601959382011012809108189460304672830311425155662729410895867817366692592034412836118770519731694023960904001515142645621734995333020525425054138063413914104218771451427276300137903532693633055205698214610938329170970581821762210369804849037678464769208008107366527126610100987230740297422463070413317170620470283139599157332131027118672977247199534759423691601766963524487626475478510625762382666413816677902204076166217958976485721619011132813146363720592336951004853641728434018979968543773811261595968994518687093249670033871714182840984215519400949095421495303745129498253225572654234407964892758900128446832447017853477355243772885116821093220364622568334168223401047301483301095751156881883953568685646391473198143540885228518070926977011615364377427935152171023113922951987395105457499847205869921366466192358241062181079698289687201053715692577205734582747720677117159831243941832374294313950754477009974735190345669454278065936940127118385590548753401320989090572126240381082425300537011605058549973157828111422991795072577485382855834463239280350949315724182384976031349021937177004468408399533562237237209764712064361998858973360751951565546300095056668121717844907990765043946388357487393250036666216830133888557410313545592257183487011504914968854640300959444692840315797630280272303613399203982724139767009962375761831697830233698256156710160855432381199139348171756339334632551310118773628882765567543896537013165170669855034258086626032190736683509282143755361669126361036330361880146899906397982010619815063976211418226506224289041071672916469412512737274338862951927101756716536548383325180822676828582270432075671647919620134386696560761659800891648714085168515367304450179907308025414480141316003087531939462124034965778873045683675038518457776937277994039814789907165246321516667491990309679034083949198373834620642151523794918090309139548379486949341195165386248872614906130449329682488303634008727437579815404876878433719249762170709376005502198512558297272570648047307579924237364498381202398066212272959081155820661559876176258366019811005977128888484076968072809446104709531545009852550882695664460885239159206050345228059040530711597174133215096831723548068912938154211867455680896699078397833839041236921108287653598782804662890295592923185707579756905270296499741320305615994508712245029517293180925982530285648328347930952946066281501742852976083159251494833206968260894616447347135719439036376982140125629555370397843162411588865783720610228701929065825764595273106675861854379155005886246831746894061604681461233171396399187028002058996472961322831705913912318465459171883597514684476760805189288272853795274123645011990597171478695665023035633858357453315484966452503949286919523212523104885064400235202594551195828504212088985533269288504523594277307492628057803709837500670257487400792221555219036673439591898754709658739542180096505838552085610257181294692551333652931816076336170360995026001632168481178846242089655333710820484442824572651535616736128193331285180686281760305101483320023110692756922385779654522871701377723492692141719926794916451992594538229930466574239928984885816434099128098720799817284989893408303783001843784791654248387069336210740511017751588185198919617019740043362411483909801159558885225596184581430120420465803779823436250174685290325308585408850131048186481785710037189369503842122774739297463578880616277823984015902173746398970799395995713720068898222827087705504682657693278574012463016491455556769966887185840799748137617811661088949024026996962642128227890192675297913334154877151391121079310085531760062925817153009208787233088560785581915160377365910754969787625084272135552085572715485235290302680306532053067283114654699047421704411101919195023581097341460098863223616569669062041868233477482989576329313514274253187978120046686222219059905058113092077533116401479672988372438559147071648488830305577992442842478452969530363410243298470774207890248659894541553972121625429767652236277934028981031789454934366379470117296823406723792373399117779434265705601326658816591702666001396748894358024456841258340581741732137524329320354183597242416882507560964161002804628196156207669035963427505100654130953523666543280991042567057012342607626254806725925895326295259115846645828814722271686604971544215568430507126108653992442512213911252715664869181126714650559883026192717284548569144856616039619417735178708221909824616144221545390576444569310764768029443975102600737899599169864153794356643099909983497433104787116492156568368073723321614830648995087746338469811234150545912867304181702681413943015751672337000932463057304776976099487103157446378101595555521211313630410588927481683411699963960747580703028928829052810182079083636791390008175906216495908585591168603979217564252761358072032566809661809875505697461164598385393976227099102618415369935331109752473472809341299023428883202548577122718938949300375546445753818000757153881027235848956036123517703795817120841129468931405304621659761149252368779730958733677261823877751259074281008757908611335442103257023260409582347639952797670395559345011000411477478062758924429206749343779018914226693637297263756717190820050187269492867824250609898588449556572974081595953863895300310115084141158561221693841229747823114296236935049043866478173930156934120407529210177250046403081799081283060348534298523824413647015017742860122350013068372596254864861154912906839748012912124156732400784156302028073857334454905853348051985651369211685796414743638582660643236381760541045034640332636648574278655300630614752925201202535179799761559252448211764043120275598681188861027267736756394619809830434333139252155669308727928708752460746008854059668487038558427150597336746028931617913009998262295846520662119264895330696205154757447726989656092047194406275127737173985199139578666403741977361105356879168379794645473320193470899811174922968671800664422562892009553416330061409991681568598187871425755928470194904971005099148677339133848018298461939367176559884301401720897586620446149865268596736641127289416639444820113713112320633867522311394852845511087002073052012962662405078240404870795555233636865187863235643780333390341944220389423295031336614000081621127604773048401257473300889555979157839122067496840539664981056219400070493383707242360386355723766015953932685677529378462074688652703870528077330198082717968667076095859860184410157226066634949025878581272903941160948904505461144297916905995169421150535454159053200541141990599711759705515031614418949385072739602368967324545701322303655730630992745743961642587941774033363577092288756514268232192758019988563931567047529105290703094660189232717510886882818332224373744686796307354917549550173917967385838315488621995303742761881288129693116968732553449920225620584664355782048721352111347612820925179334765839739369768023863752807826785010851787437629615590084283455435243157421733461440015388321773534145164434991616436197530166539549198588012334377374786962341933892513741791147608619546282373158310821101234980472115940767378687217624249131181840315714654303406198778971565518641719816217428084161927195781952608974390881871045930061297869366058458666667865486109090675923991034817742287758088521215614765431731193351382286401651127808500710172313955513369977169256408459318219516416994363328888331460796941251640568739219565425872066444252061423437325823468644417837366080516938561103481910800001603356131829206344162051736206257117107796410081749379498728875044363838013885797790320543745572325983639323583876036095485333986678004816045749593371511535588592418925179227092918647220077597851356445347454557783230978889815193364594619055720071959662348451768939227412711434432730876572513067822719653101717899963140461399912608460930099315796618895205767573067389486497747952410138179698985808528914724117774340429177827120534317350621471753516192645115181216297827855179528072987168815967912231840860318259755594419892830356620579615441792849379957239542355575091633594294607368957100652900678183907157759614417590599370961072934297472859626611807997024059474829299332357485005303590917220913730143603862834680197359229254090354119264188684996044469525791905070671834517705716225742926045712234465488473104071586920369377087185970293742548765460371228639603553462354158640923733295028810462519560990449721898614604267363235137390973977814706531717872461808914596925335417407193062174325826337334764678879612272742792838081840873703668372172898799062376344209528335218239023521162424825351164645154813404759964987790700808201439360013870865729460240610042872388673132709652485244040360312699074736444907777604938291356461098544191753743487758952040836904528491150290562368064187498340203570740150065152022781037360100009884829607010951210951969775558560542733843528406100000578156211571993158845572509739185340499451094337281733760526726104192058478450221365339649929078215444280835276294107546977397926747096204672915541540659423630538285030785794055648461197675757319631235931020813817104450749893065028554787343611902406241861464662754311980472267564287092115823016665350902844524499705209202714676883998627612917903227057215779983514261274187674611899176511943401914907999288740032187313371421390129246874147509639121064576769678383951253619197684849489504592247092669259694272851167507656209252465381365160173089816800129947075796950737942605862428227011409261661192767705017625125064122103940075916414034175819174193348621404725061046675144051344269682129087559597468205619272878491930258734700201411129353970528345658930962776771227219497108806792685478398616757965609265488330107722877877307854941132853068569844678159696429484384301779453838358594057988991216272434872949518312803815248980268068527923827851106367398558388789201806380512162167699438763922260789547661194060710081477163084973263802082896850372604611184493766821110622675157579280768828124412932553765015656590314100195247330402494993957836498143887696790933170225732116739872114210143987608783403212039699505908890896632449988449370891151692652647585656230721592349613018879197704164813734039685144893475783460737575058366110815755792209598669460871934612222249873171078057214873483868255144588755079508844820105760663209433016188109007599315552234444850200651774955640727482593718803743358847773331227272475875807247315976832645226789559907842987301753269864986038682392846350100756317794623118000873428343701100707656704564813748936318863402207480524705252064810722383459350625623314243598772621285155888877498712968979737342600159043069206490363489011819197372850773642399202758316592090162057885198970582381019716748666950046429040480540781705368754752034491812336082374087543715244038073463845680899521172752535701670459794922233537837737369732790433700701649008641220746819415091108589964402372424181093113223003660955047248486479785828761948335934519167104720635364029196910677387526138121997240539020012675183240608791326295102219882671448339611575779651481420013161793893253293393283839382850959218540823019034703412162363123281705973403910810616284273444832238642813916010146231346341336414274821480823604752234923605338788794707498636649714075390189406218790971723190694673096279518262084588424554191882092249629651596773934467440169465334317443428898528744335120921270893238636190329992137156626032857875889010227201205564845199252697531945617018531016676689932583462483830740642871726366025460521899718661214420080512597568437204228573518596990928220799689108072119308266061533141390073011459929861674733090952758525132022949663876589697124586471147923176086069758252819823279945751095749951920233648962043815490550339058702903786662059828444230569693473043056406738950086889088367111141914200459193435924412568820382270491593056070307724631849725599663436495479654599179047555492122814915693958428324736137049449154510517780941775577039675320903794491590749652612225764927746458984364146005983881985836473076822222901146013282688107025261117568364381379115643223602716509245988101964414941624521458243940568124251657314265177973566585031506944173904153071117363288731856022978715940677138116144362091616200224524761062616428692669904638370400028018175875460905386734837872126445171093589051892470731418832580401474832551366546847285483152243485833634700510117790369763040131972777491205685422531699456861576939965139759441277748146152392851538376352362589233290973064090042393008761856754779232644252188224741311503923495633712417315091700419690990866608633307697788877473843564461084009452783009818019039931122042459059359710668783178693996695270347797263672612655599978555369163571118082209943907067706108496261664716747515399061751345698778427222317314065483132775311831165182496019139618469253009646515044963120891571269642404064196835520931218521609686893853390418923134336456750340655053916402364394834800493255992677093428911875530170523626483088422185623060320963965119098207642787903004330209472909214473269376153273739836326600386183725367957130432348262057846589330096041875444916060099917819183240639948122289826130409655417746135017720786558706666279926994031024256336921542188644966925833807170307904487301507825222739536239838902843809308897035172538666672915557346457108704424281702921338146189678225886121430876379104428878273747138927920684907497849524344082579475621120363154196054983668741125099504950243595413896642523505265540755703082743446643264691270412993203033896058075499863559066978791103765312807576616030010369559393299193762822079180030361126132468454069036532754914140796706615256629152699725543180880102463069105540759244315014185291058784706440536045683768049629371649036837918454777266099308742629607220375441220146554324219180212264770000953329892106896323475237697824886487032989503177701690230594075541470752607086124680536395086201928223553148475300336051918250588040259450495387002164922822333799086461251924373713127001058270856063321344704331836004837092077482708165507672870223108144360668603491525630364757826304942650350236554536470079442151137125916173474782644463975383155351189984437809044796274641906634924713588826429465754330943013093599654683410927473655574032337434522508315322996047139546052537442373588762484442114821466217620625040806297220313086942890934437217736236655939262594460643792206284347582032005554943769809598385581959276392768589053426594398148479557348951591944184557386670442639431460340244505232346863658834423685135748406626122631397599625238541839303385433671468999798331471660203455548295965505479581025082043370261228519033771567882814096435453796330656382498450009951118764314954232908795829366986186993965707663430845072378452519563983034681566622513441397752685318676827778195456347399966174668578164418123359258974637199802598217568842401575002229509634347079129235418514442258646218022431777925516398406875957993282874455183333772182291406693603532031136392046819291491112749577263662913143729071364493449117971351017230412043371811230203522207079516314850793861079542087369922621000053592171232438902736481502559950011566429254008749242945090497465805876332241084608635284183149005103486204793021108996411860666912111744981358439571928742031740210833236876190695353731195637081530502070834590372144842119893979037254341365999011335425292913321365115901631059591800966144482420597248760006159212262716442287758105504389858480705605142186664469149041922517839995856196057205580339923833795460453568311993830106645391982771217391396511734484663068193097739364329879758697504111322795430372464765908986557938876554659283561164881141631208520236104519910921169301981604723443008450800761021176672747413751998122172914819681128103016095240728134543117211688698346689769240217336569329211204137263756403148177714909977523790561681925897135003995216500720026951358347489719814882503530589582400723543821892239629920988006154811411173214653
